{"version":3,"sources":["webpack:///./src/components/NetSearch/NetSearch.vue?8b95","webpack:///./src/base/SearchBox/SearchBox.vue?cebf","webpack:///src/base/SearchBox/SearchBox.vue","webpack:///./src/base/SearchBox/SearchBox.vue","webpack:///./src/base/SearchBox/SearchBox.vue?a8b5","webpack:///src/base/SearchSuggest/SearchSuggest.vue","webpack:///./src/base/SearchSuggest/SearchSuggest.vue?4cd5","webpack:///./src/base/SearchSuggest/SearchSuggest.vue","webpack:///./src/base/SearchSuggest/SearchSuggest.vue?019c","webpack:///src/components/NetSearch/NetSearch.vue","webpack:///./src/components/NetSearch/NetSearch.vue?b87e","webpack:///./src/components/NetSearch/NetSearch.vue","webpack:///./src/base/SearchBox/SearchBox.vue?75a9","webpack:///./src/base/SearchSuggest/SearchSuggest.vue?a843","webpack:///./src/components/NetSearch/NetSearch.vue?d03d"],"names":["name","data","query","methods","this","$refs","blur","$watch","_vm","_h","$createElement","_c","_self","staticClass","_v","directives","rawName","value","expression","ref","attrs","domProps","on","$event","target","composing","close","components","BaseScroll","NoResult","offset","result","hasMore","pullup","limit","type","beforeScroll","artist","props","String","default","showSinger","Boolean","concat","songs","_hasMore","$emit","suggest","refresh","length","_search","$toast","item","songItem","map","id","mid","al","singer","ar","album","duration","dt","image","picUrl","insertSong","watch","newQuery","searchMore","listScroll","_l","index","key","selectItem","class","getIconCls","_s","getDisplayName","mixins","hotkey","refreshDelay","SearchBox","SearchSuggest","computed","_getHotKey","code","searchBox","$router","back","playList","bottom","shortCutWrapper","style","shortCut","searchResult","setQuery","deleteSearchHistory","$dialog","saveSearchHistory","setTimeout","searchBack","changeQuery","searchHistory","deleteAll","addQuery","deletOne","searchWord","content","score","blurInput","_saveSeachHistory"],"mappings":"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","file":"js/4.db8f74a6.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"search\",staticClass:\"search\"},[_c('div',{staticClass:\"search-box-wrapper\"},[_c('div',{staticClass:\"search-back\",on:{\"click\":_vm.searchBack}},[_c('span',{staticClass:\"iconfont iconfanhui\"})]),_vm._v(\" \"),_c('search-box',{ref:\"searchBox\",staticClass:\"box\",on:{\"onchangeQuery\":_vm.changeQuery}})],1),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.query),expression:\"!query\"}],ref:\"shortCutWrapper\",staticClass:\"shortCut-wrapper\"},[_c('base-scroll',{ref:\"shortCut\",staticClass:\"shortCut\",attrs:{\"delayTime\":_vm.refreshDelay}},[_c('div',[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.searchHistory.length),expression:\"searchHistory.length\"}],staticClass:\"search-history\"},[_c('h1',{staticClass:\"title\"},[_c('span',{staticClass:\"text\"},[_vm._v(\"搜索历史\")]),_vm._v(\" \"),_c('span',{staticClass:\"iconfont iconlajitong1\",on:{\"click\":_vm.deleteAll}})]),_vm._v(\" \"),_c('div',{staticClass:\"search-list\"},[_c('ul',_vm._l((this.searchHistory),function(item,index){return _c('li',{key:index,staticClass:\"search-item\"},[_c('span',{on:{\"click\":function($event){return _vm.addQuery(item)}}},[_vm._v(_vm._s(item))]),_vm._v(\" \"),_c('span',{staticClass:\"iconfont iconiconjia\",on:{\"click\":function($event){return _vm.deletOne(item)}}})])}),0)])]),_vm._v(\" \"),_c('div',{staticClass:\"hotKey\"},[_c('h1',{staticClass:\"title\"},[_vm._v(\"热搜榜\")]),_vm._v(\" \"),_c('ul',_vm._l((_vm.hotkey),function(item,index){return _c('li',{key:index,staticClass:\"hot-item\",on:{\"click\":function($event){return _vm.addQuery(item.searchWord)}}},[_c('span',{staticClass:\"rank-index\"},[_vm._v(_vm._s(index+1))]),_vm._v(\" \"),_c('div',{staticClass:\"hot-title\"},[_c('div',[_c('span',[_vm._v(_vm._s(item.searchWord))])]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(item.content))])]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(item.score))])])}),0)])])])],1),_vm._v(\" \"),_c('div',{ref:\"searchResult\",staticClass:\"search-result\"},[_c('search-suggest',{ref:\"suggest\",attrs:{\"query\":_vm.query},on:{\"listScroll\":_vm.blurInput,\"select\":_vm._saveSeachHistory}})],1),_vm._v(\" \"),_c('transition',[_c('router-view')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js?cacheDirectory!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./SearchBox.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js?cacheDirectory!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./SearchBox.vue?vue&type=script&lang=js&\"","<template>\r\n  <div class=\"search-box\">\r\n    <span class=\"iconfont iconsousuo\"></span>\r\n    <input ref=\"query\" v-model=\"query\" placeholder=\"搜索歌曲歌手\" class=\"query\" type=\"text\" />\r\n    <span @click=\"close\" v-show=\"query\" class=\"iconfont iconguanbi\"></span>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { debounce } from \"common/js/until.js\";\r\nexport default {\r\n  name: \"SearchBox\",\r\n  data() {\r\n    return {\r\n      query: \"\"\r\n    };\r\n  },\r\n  methods: {\r\n    close() {\r\n      this.query = \"\";\r\n    },\r\n    setQuery(query) {\r\n      this.query = query;\r\n    },\r\n    blur() {\r\n      this.$refs.query.blur();\r\n    }\r\n  },\r\n  created() {\r\n    this.$watch(\r\n      \"query\",\r\n      debounce(query => {\r\n        this.$emit(\"onchangeQuery\", query);\r\n      }, 200)\r\n    );\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.search-box {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 0 6px;\r\n  background: #333;\r\n  height: 40px;\r\n  box-sizing: border-box;\r\n  align-items: center;\r\n  border-radius: 6px;\r\n\r\n  .query {\r\n    flex: 1;\r\n    border-color: yellow;\r\n    color: #ffff;\r\n    background: #333;\r\n    margin: 0 5px;\r\n    font-size: 14px;\r\n    line-height: 18px;\r\n  }\r\n\r\n  .iconguanbi {\r\n    position: relative;\r\n    z-index: 20;\r\n  }\r\n}\r\n</style>\r\n","import { render, staticRenderFns } from \"./SearchBox.vue?vue&type=template&id=6eac9f81&scoped=true&\"\nimport script from \"./SearchBox.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchBox.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SearchBox.vue?vue&type=style&index=0&id=6eac9f81&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6eac9f81\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search-box\"},[_c('span',{staticClass:\"iconfont iconsousuo\"}),_vm._v(\" \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.query),expression:\"query\"}],ref:\"query\",staticClass:\"query\",attrs:{\"placeholder\":\"搜索歌曲歌手\",\"type\":\"text\"},domProps:{\"value\":(_vm.query)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.query=$event.target.value}}}),_vm._v(\" \"),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.query),expression:\"query\"}],staticClass:\"iconfont iconguanbi\",on:{\"click\":_vm.close}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <base-scroll\r\n    ref=\"suggest\"\r\n    :data=\"result\"\r\n    v-show=\"query\"\r\n    class=\"suggest\"\r\n    :pullup=\"pullup\"\r\n    @scrollToEnd=\"searchMore\"\r\n    :beforeScroll=\"beforeScroll\"\r\n    @beforeScroll=\"listScroll\"\r\n  >\r\n    <ul class=\"suggest-list\">\r\n      <li\r\n        class=\"suggest-item\"\r\n        :key=\"index\"\r\n        v-for=\"(item,index) in result\"\r\n        @click=\"selectItem(item)\"\r\n      >\r\n        <div class=\"icon\">\r\n          <span :class=\"getIconCls()\"></span>\r\n        </div>\r\n        <div class=\"name\">\r\n          <p class=\"text\" v-html=\"getDisplayName(item)\"></p>\r\n        </div>\r\n      </li>\r\n      <van-loading v-show=\"hasMore\" type=\"spinner\" color=\"#1989fa\">加载中...</van-loading>\r\n    </ul>\r\n    <div v-show=\"!hasMore && !result.length\">\r\n      <no-result title=\"没有搜到任何歌曲\"></no-result>\r\n    </div>\r\n  </base-scroll>\r\n</template>\r\n<script>\r\nimport NoResult from \"base/NoResult/NoResult.vue\";\r\nimport { getSearch, getSongDetail } from \"api/index.js\";\r\nimport { createSong } from \"common/js/song\";\r\nimport BaseScroll from \"base/BaseScroll/BaseScroll.vue\";\r\nimport { mapMutations, mapActions } from \"vuex\";\r\nexport default {\r\n  name: \"Suggest\",\r\n  components: {\r\n    BaseScroll,\r\n    NoResult\r\n  },\r\n  data() {\r\n    return {\r\n      offset: 0,\r\n      result: [],\r\n      hasMore: true,\r\n      pullup: true,\r\n      limit: 15,\r\n      type: 1,\r\n      beforeScroll: true,\r\n      artist: []\r\n    };\r\n  },\r\n  props: {\r\n    query: {\r\n      type: String,\r\n      default: \"\"\r\n    },\r\n    showSinger: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n  },\r\n  methods: {\r\n    async _search() {\r\n      // 重置scroll参数，以防数据积累,scroll破环\r\n      this.offset = 0;\r\n      this.hasMore = true;\r\n      this.result = [];\r\n      const { code, result } = await getSearch(\r\n        this.query,\r\n        this.limit,\r\n        this.offset,\r\n        this.type\r\n      );\r\n      this.result = this.result.concat(result.songs);\r\n      this._hasMore(this.result);\r\n    },\r\n    listScroll() {\r\n      this.$emit(\"listScroll\");\r\n    },\r\n    refresh() {\r\n      this.$refs.suggest.refresh();\r\n    },\r\n    _hasMore(data) {\r\n      if (!data.length) {\r\n        this.hasMore = false;\r\n      }\r\n    },\r\n    searchMore() {\r\n      if (!this.hasMore) {\r\n        this.$toast(\"哥 已经到底了,没有数据了\");\r\n        return;\r\n      }\r\n      this.offset++;\r\n      this._search();\r\n    },\r\n    getIconCls(item) {\r\n      if(item) {\r\n       return \"iconfont iconicon-test\";\r\n      }\r\n      \r\n    },\r\n    getDisplayName(item) {\r\n      if(item) {\r\n        return `${item.name}-${item.artists[0].name}`;\r\n      } \r\n    },\r\n    async selectItem(item) {\r\n      const { songs } = await getSongDetail(item.id);\r\n      const songItem = songs.map(({ id, name, ar, al, dt }) => {\r\n        return createSong({\r\n          id,\r\n          mid: al.id,\r\n          singer: ar[0].name,\r\n          name,\r\n          album: al.name,\r\n          duration: dt / 1000,\r\n          image: al.picUrl\r\n        });\r\n      });\r\n      this.insertSong(songItem[0]);\r\n\r\n      //派发和搜素历史相关的事件\r\n      this.$emit(\"select\");\r\n    },\r\n    ...mapMutations([\"SET_SINGER\"]),\r\n    ...mapActions([\"insertSong\"])\r\n  },\r\n  watch: {\r\n    query(newQuery) {\r\n      if (!newQuery) {\r\n        return;\r\n      }\r\n      this._search();\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n@import \"~common/less/mixin.less\";\r\n\r\n.suggest {\r\n  height: 100%;\r\n  overflow: hidden;\r\n\r\n  .suggest-list {\r\n    padding: 0 30px;\r\n\r\n    .suggest-item {\r\n      display: flex;\r\n      line-height: 22px;\r\n      padding-bottom: 20px;\r\n\r\n      .icon {\r\n        margin-right: 10px;\r\n      }\r\n\r\n      .name {\r\n        font-size: 14px;\r\n        .no-wrap;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.suggest {\r\n  /deep/ .van-loading {\r\n    text-align: center;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js?cacheDirectory!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./SearchSuggest.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js?cacheDirectory!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./SearchSuggest.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SearchSuggest.vue?vue&type=template&id=0360d53e&scoped=true&\"\nimport script from \"./SearchSuggest.vue?vue&type=script&lang=js&\"\nexport * from \"./SearchSuggest.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SearchSuggest.vue?vue&type=style&index=0&id=0360d53e&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0360d53e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('base-scroll',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.query),expression:\"query\"}],ref:\"suggest\",staticClass:\"suggest\",attrs:{\"data\":_vm.result,\"pullup\":_vm.pullup,\"beforeScroll\":_vm.beforeScroll},on:{\"scrollToEnd\":_vm.searchMore,\"beforeScroll\":_vm.listScroll}},[_c('ul',{staticClass:\"suggest-list\"},[_vm._l((_vm.result),function(item,index){return _c('li',{key:index,staticClass:\"suggest-item\",on:{\"click\":function($event){return _vm.selectItem(item)}}},[_c('div',{staticClass:\"icon\"},[_c('span',{class:_vm.getIconCls()})]),_vm._v(\" \"),_c('div',{staticClass:\"name\"},[_c('p',{staticClass:\"text\",domProps:{\"innerHTML\":_vm._s(_vm.getDisplayName(item))}})])])}),_vm._v(\" \"),_c('van-loading',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.hasMore),expression:\"hasMore\"}],attrs:{\"type\":\"spinner\",\"color\":\"#1989fa\"}},[_vm._v(\"加载中...\")])],2),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.hasMore && !_vm.result.length),expression:\"!hasMore && !result.length\"}]},[_c('no-result',{attrs:{\"title\":\"没有搜到任何歌曲\"}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div ref=\"search\" class=\"search\">\r\n    <div class=\"search-box-wrapper\">\r\n      <div @click=\"searchBack\" class=\"search-back\">\r\n        <span class=\"iconfont iconfanhui\"></span>\r\n      </div>\r\n      <search-box class=\"box\" @onchangeQuery=\"changeQuery\" ref=\"searchBox\"></search-box>\r\n    </div>\r\n    <div ref=\"shortCutWrapper\" v-show=\"!query\" class=\"shortCut-wrapper\">\r\n      <base-scroll :delayTime=\"refreshDelay\" ref=\"shortCut\" class=\"shortCut\">\r\n        <div>\r\n          <div class=\"search-history\" v-show=\"searchHistory.length\">\r\n            <h1 class=\"title\">\r\n              <span class=\"text\">搜索历史</span>\r\n              <span @click=\"deleteAll\" class=\"iconfont iconlajitong1\"></span>\r\n            </h1>\r\n            <div class=\"search-list\">\r\n              <ul>\r\n                <li class=\"search-item\" :key=\"index\" v-for=\"(item,index) in this.searchHistory\">\r\n                  <span @click=\"addQuery(item)\">{{ item }}</span>\r\n                  <span @click=\"deletOne(item)\" class=\"iconfont iconiconjia\"></span>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <div class=\"hotKey\">\r\n            <h1 class=\"title\">热搜榜</h1>\r\n            <ul>\r\n              <li\r\n                :key=\"index\"\r\n                v-for=\"(item,index) in hotkey\"\r\n                class=\"hot-item\"\r\n                @click=\"addQuery(item.searchWord)\"\r\n              >\r\n                <span class=\"rank-index\">{{index+1}}</span>\r\n                <div class=\"hot-title\">\r\n                  <div>\r\n                    <span>{{item.searchWord}}</span>\r\n                  </div>\r\n                  <span>{{ item.content }}</span>\r\n                </div>\r\n                <span>{{ item.score }}</span>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </base-scroll>\r\n    </div>\r\n    <div ref=\"searchResult\" class=\"search-result\">\r\n      <search-suggest\r\n        ref=\"suggest\"\r\n        @listScroll=\"blurInput\"\r\n        @select=\"_saveSeachHistory\"\r\n        :query=\"query\"\r\n      ></search-suggest>\r\n    </div>\r\n    <transition>\r\n      <router-view></router-view>\r\n    </transition>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapActions, mapGetters } from \"vuex\";\r\n\r\nimport SearchBox from \"base/SearchBox/SearchBox.vue\";\r\n\r\nimport { getHotKey } from \"api/index.js\";\r\n\r\nimport SearchSuggest from \"base/SearchSuggest/SearchSuggest.vue\";\r\n\r\nimport BaseScroll from \"base/BaseScroll/BaseScroll.vue\";\r\n\r\nimport { playListMixin } from \"common/js/mixin\";\r\n\r\nexport default {\r\n  name: \"search\",\r\n  mixins: [playListMixin],\r\n  data() {\r\n    return {\r\n      hotkey: [],\r\n      query: \"\",\r\n      refreshDelay: 120\r\n    };\r\n  },\r\n  components: {\r\n    SearchBox,\r\n    SearchSuggest,\r\n    BaseScroll\r\n  },\r\n  computed: {\r\n    ...mapGetters([\"searchHistory\"])\r\n  },\r\n  created() {\r\n    this._getHotKey();\r\n  },\r\n  methods: {\r\n    async _getHotKey() {\r\n      const { code, data } = await getHotKey();\r\n      if (code === 200) {\r\n        // const { data } = result;\r\n        this.hotkey = data;\r\n      }\r\n    },\r\n    // 监听query变化 顺便将query传过来\r\n    changeQuery(query) {\r\n      this.query = query;\r\n    },\r\n    blurInput() {\r\n      this.$refs.searchBox.blur();\r\n    },\r\n    searchBack() {\r\n      this.$router.back();\r\n    },\r\n    handlePlaylist(playList) {\r\n      const bottom = playList.length > 0 ? \"60px\" : 0;\r\n      this.$refs.shortCutWrapper.style.bottom = bottom;\r\n      this.$refs.shortCut.refresh();\r\n      this.$refs.searchResult.style.bottom = bottom;\r\n      this.$refs.suggest.refresh();\r\n    },\r\n    addQuery(query) {\r\n      this.$refs.searchBox.setQuery(query);\r\n    },\r\n    deletOne(item) {\r\n      this.deleteSearchHistory(item);\r\n    },\r\n    deleteAll() {\r\n      this.$dialog();\r\n    },\r\n    _saveSeachHistory() {\r\n      this.saveSearchHistory(this.query);\r\n    },\r\n    ...mapActions([\r\n      \"saveSearchHistory\",\r\n      \"deleteSearchHistory\",\r\n      \"clearSearchHistory\"\r\n    ])\r\n  },\r\n  watch: {\r\n    query(newQuery) {\r\n      if (!newQuery) {\r\n        // suggest 切换到search 从有到无的变化\r\n        setTimeout(() => {\r\n          this.$refs.shortCut.refresh();\r\n        }, 20);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\nbody {\r\n  /deep/ .van-dialog__header {\r\n    padding-top: 0;\r\n  }\r\n}\r\n\r\n@import \"~common/less/variable.less\";\r\n\r\n.search {\r\n  position: fixed;\r\n  top: 0;\r\n  bottom: 0;\r\n  width: 100%;\r\n  z-index: 100;\r\n  background-color: @color-background;\r\n\r\n  .search-box-wrapper {\r\n    padding: 10px;\r\n    display: flex;\r\n\r\n    .search-back {\r\n      width: 30px;\r\n      flex: 0 0 30px;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n\r\n      .iconfanhui {\r\n        font-size: 20px;\r\n      }\r\n    }\r\n\r\n    .box {\r\n      flex: 1;\r\n    }\r\n  }\r\n\r\n  .shortCut-wrapper {\r\n    position: fixed;\r\n    top: 80px;\r\n    bottom: 0;\r\n    width: 100%;\r\n    z-index: 5;\r\n\r\n    .shortCut {\r\n      height: 100%;\r\n      overflow: hidden;\r\n\r\n      .hotKey {\r\n        margin: 20px 20px 0 20px;\r\n\r\n        .hot-item {\r\n          display: flex;\r\n          padding: 0 10px;\r\n          line-height: 24px;\r\n          background: #3f00ff;\r\n          margin-right: 5px;\r\n          margin-bottom: 10px;\r\n          border-radius: 5px;\r\n          font-size: 14px;\r\n\r\n          .rank-index {\r\n            margin-right: 6px;\r\n          }\r\n\r\n          .hot-title {\r\n            flex: 1;\r\n          }\r\n        }\r\n\r\n        .title {\r\n          margin-bottom: 10px;\r\n          font-size: 18px;\r\n        }\r\n      }\r\n\r\n      .search-history {\r\n        margin: 20px 20px 0 20px;\r\n\r\n        .title {\r\n          display: flex;\r\n          justify-content: space-between;\r\n          line-height: 40px;\r\n\r\n          .text {\r\n            font-size: 14px;\r\n          }\r\n        }\r\n\r\n        .search-list {\r\n          .search-item {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            line-height: 40px;\r\n            font-size: 14px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .search-result {\r\n    position: fixed;\r\n    top: 74px;\r\n    bottom: 0;\r\n    width: 100%;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js?cacheDirectory!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./NetSearch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js?cacheDirectory!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./NetSearch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./NetSearch.vue?vue&type=template&id=73134938&scoped=true&\"\nimport script from \"./NetSearch.vue?vue&type=script&lang=js&\"\nexport * from \"./NetSearch.vue?vue&type=script&lang=js&\"\nimport style0 from \"./NetSearch.vue?vue&type=style&index=0&id=73134938&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"73134938\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@3.5.2@css-loader/dist/cjs.js??ref--5-1!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--5-2!../../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--5-3!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./SearchBox.vue?vue&type=style&index=0&id=6eac9f81&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@3.5.2@css-loader/dist/cjs.js??ref--5-1!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--5-2!../../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--5-3!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./SearchBox.vue?vue&type=style&index=0&id=6eac9f81&lang=less&scoped=true&\"","import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@3.5.2@css-loader/dist/cjs.js??ref--5-1!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--5-2!../../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--5-3!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./SearchSuggest.vue?vue&type=style&index=0&id=0360d53e&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@3.5.2@css-loader/dist/cjs.js??ref--5-1!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--5-2!../../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--5-3!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./SearchSuggest.vue?vue&type=style&index=0&id=0360d53e&lang=less&scoped=true&\"","import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@3.5.2@css-loader/dist/cjs.js??ref--5-1!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--5-2!../../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--5-3!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./NetSearch.vue?vue&type=style&index=0&id=73134938&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@3.5.2@css-loader/dist/cjs.js??ref--5-1!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--5-2!../../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--5-3!../../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./NetSearch.vue?vue&type=style&index=0&id=73134938&lang=less&scoped=true&\""],"sourceRoot":""}