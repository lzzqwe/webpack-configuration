(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{234:function(e,t,s){"use strict";s.r(t);s(63),s(64);var r=s(11),a=s(18),i={name:"SearchBox",data:()=>({query:""}),methods:{close(){this.query=""},setQuery(e){this.query=e},blur(){this.$refs.query.blur()}},created(){this.$watch("query",Object(a.a)(e=>{this.$emit("onchangeQuery",e)},200))}},c=(s(280),s(8)),n=Object(c.a)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-box"},[s("span",{staticClass:"iconfont iconsousuo"}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],ref:"query",staticClass:"query",attrs:{placeholder:"搜索歌曲歌手",type:"text"},domProps:{value:e.query},on:{input:function(t){t.target.composing||(e.query=t.target.value)}}}),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.query,expression:"query"}],staticClass:"iconfont iconguanbi",on:{click:e.close}})])}),[],!1,null,"6eac9f81",null).exports,o=s(245),l=s(271),u=s(247),h=s(42);function f(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function p(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var y={name:"Suggest",components:{BaseScroll:h.a,NoResult:l.a},data:()=>({offset:0,result:[],hasMore:!0,pullup:!0,limit:15,type:1,beforeScroll:!0,artist:[]}),props:{query:{type:String,default:""},showSinger:{type:Boolean,default:!0}},methods:function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?f(Object(s),!0).forEach((function(t){p(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({async _search(){this.offset=0,this.hasMore=!0,this.result=[];const{code:e,result:t}=await Object(o.j)(this.query,this.limit,this.offset,this.type);this.result=this.result.concat(t.songs),this._hasMore(this.result)},listScroll(){this.$emit("listScroll")},refresh(){this.$refs.suggest.refresh()},_hasMore(e){e.length||(this.hasMore=!1)},searchMore(){this.hasMore?(this.offset++,this._search()):this.$toast("哥 已经到底了,没有数据了")},getIconCls(e){if(e)return"iconfont iconicon-test"},getDisplayName(e){if(e)return"".concat(e.name,"-").concat(e.artists[0].name)},async selectItem(e){const{songs:t}=await Object(o.m)(e.id),s=t.map(e=>{let{id:t,name:s,ar:r,al:a,dt:i}=e;return Object(u.a)({id:t,mid:a.id,singer:r[0].name,name:s,album:a.name,duration:i/1e3,image:a.picUrl})});this.insertSong(s[0]),this.$emit("select")}},Object(r.d)(["SET_SINGER"]),{},Object(r.b)(["insertSong"])),watch:{query(e){e&&this._search()}}},v=(s(283),Object(c.a)(y,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("base-scroll",{directives:[{name:"show",rawName:"v-show",value:e.query,expression:"query"}],ref:"suggest",staticClass:"suggest",attrs:{data:e.result,pullup:e.pullup,beforeScroll:e.beforeScroll},on:{scrollToEnd:e.searchMore,beforeScroll:e.listScroll}},[s("ul",{staticClass:"suggest-list"},[e._l(e.result,(function(t,r){return s("li",{key:r,staticClass:"suggest-item",on:{click:function(s){return e.selectItem(t)}}},[s("div",{staticClass:"icon"},[s("span",{class:e.getIconCls()})]),e._v(" "),s("div",{staticClass:"name"},[s("p",{staticClass:"text",domProps:{innerHTML:e._s(e.getDisplayName(t))}})])])})),e._v(" "),s("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.hasMore,expression:"hasMore"}],attrs:{type:"spinner",color:"#1989fa"}},[e._v("加载中...")])],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.hasMore&&!e.result.length,expression:"!hasMore && !result.length"}]},[s("no-result",{attrs:{title:"没有搜到任何歌曲"}})],1)])}),[],!1,null,"0360d53e",null).exports);function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function b(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){m(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function m(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var g={name:"search",mixins:[s(246).a],data:()=>({hotkey:[],query:"",refreshDelay:120}),components:{SearchBox:n,SearchSuggest:v,BaseScroll:h.a},computed:b({},Object(r.c)(["searchHistory"])),created(){this._getHotKey()},methods:b({async _getHotKey(){const{code:e,data:t}=await Object(o.c)();200===e&&(this.hotkey=t)},changeQuery(e){this.query=e},blurInput(){this.$refs.searchBox.blur()},searchBack(){this.$router.back()},handlePlaylist(e){const t=e.length>0?"60px":0;this.$refs.shortCutWrapper.style.bottom=t,this.$refs.shortCut.refresh(),this.$refs.searchResult.style.bottom=t,this.$refs.suggest.refresh()},addQuery(e){this.$refs.searchBox.setQuery(e)},deletOne(e){this.deleteSearchHistory(e)},deleteAll(){this.$dialog()},_saveSeachHistory(){this.saveSearchHistory(this.query)}},Object(r.b)(["saveSearchHistory","deleteSearchHistory","clearSearchHistory"])),watch:{query(e){e||setTimeout(()=>{this.$refs.shortCut.refresh()},20)}}},O=(s(284),Object(c.a)(g,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"search",staticClass:"search"},[s("div",{staticClass:"search-box-wrapper"},[s("div",{staticClass:"search-back",on:{click:e.searchBack}},[s("span",{staticClass:"iconfont iconfanhui"})]),e._v(" "),s("search-box",{ref:"searchBox",staticClass:"box",on:{onchangeQuery:e.changeQuery}})],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.query,expression:"!query"}],ref:"shortCutWrapper",staticClass:"shortCut-wrapper"},[s("base-scroll",{ref:"shortCut",staticClass:"shortCut",attrs:{delayTime:e.refreshDelay}},[s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:e.searchHistory.length,expression:"searchHistory.length"}],staticClass:"search-history"},[s("h1",{staticClass:"title"},[s("span",{staticClass:"text"},[e._v("搜索历史")]),e._v(" "),s("span",{staticClass:"iconfont iconlajitong1",on:{click:e.deleteAll}})]),e._v(" "),s("div",{staticClass:"search-list"},[s("ul",e._l(this.searchHistory,(function(t,r){return s("li",{key:r,staticClass:"search-item"},[s("span",{on:{click:function(s){return e.addQuery(t)}}},[e._v(e._s(t))]),e._v(" "),s("span",{staticClass:"iconfont iconiconjia",on:{click:function(s){return e.deletOne(t)}}})])})),0)])]),e._v(" "),s("div",{staticClass:"hotKey"},[s("h1",{staticClass:"title"},[e._v("热搜榜")]),e._v(" "),s("ul",e._l(e.hotkey,(function(t,r){return s("li",{key:r,staticClass:"hot-item",on:{click:function(s){return e.addQuery(t.searchWord)}}},[s("span",{staticClass:"rank-index"},[e._v(e._s(r+1))]),e._v(" "),s("div",{staticClass:"hot-title"},[s("div",[s("span",[e._v(e._s(t.searchWord))])]),e._v(" "),s("span",[e._v(e._s(t.content))])]),e._v(" "),s("span",[e._v(e._s(t.score))])])})),0)])])])],1),e._v(" "),s("div",{ref:"searchResult",staticClass:"search-result"},[s("search-suggest",{ref:"suggest",attrs:{query:e.query},on:{listScroll:e.blurInput,select:e._saveSeachHistory}})],1),e._v(" "),s("transition",[s("router-view")],1)],1)}),[],!1,null,"73134938",null));t.default=O.exports},256:function(e,t,s){},258:function(e,t,s){},259:function(e,t,s){},280:function(e,t,s){"use strict";var r=s(256);s.n(r).a},283:function(e,t,s){"use strict";var r=s(258);s.n(r).a},284:function(e,t,s){"use strict";var r=s(259);s.n(r).a}}]);
//# sourceMappingURL=4.db8f74a6.js.map